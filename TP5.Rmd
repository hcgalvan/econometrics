---
title: "TP 5 - Data Panel"
output:
  html_notebook: default
  pdf_document: default
---

** Cu치l es la principal utilidad de los modelos de datos en Panel?  existe alguna diferencia entre aplicar efectos fijos o aleatorios en los modelos? Explique detalladamente los principales problemas que enfrentan estos tipos de modelos.**

Los modelos de datos en Panel tienen como principal utilidad el an치lisis de datos de panel, los cuales combinan datos de corte transversal (es decir, datos recopilados en un mismo per칤odo de tiempo para diferentes individuos, empresas, pa칤ses, etc.) con datos de series de tiempo (datos recopilados a lo largo del tiempo para los mismos individuos).

La elecci칩n entre utilizar efectos fijos o aleatorios en los modelos de datos de panel depende principalmente de las suposiciones que se hagan sobre la relaci칩n entre los efectos no observados y las variables explicativas.

**Efectos fijos:** - Suponen que las variables no observadas est치n correlacionadas con las variables explicativas. - Permiten controlar por heterogeneidad no observada constante en el tiempo. - 칔tiles cuando se est치 analizando un conjunto espec칤fico de individuos y se desea inferir los efectos para esos individuos en particular.

**Efectos aleatorios:** - Suponen que las variables no observadas no est치n correlacionadas con las variables explicativas. - Permiten estimar los efectos de variables que var칤an a trav칠s del tiempo y entre individuos. - 칔tiles cuando se desea inferir los efectos para una poblaci칩n m치s amplia de la cual la muestra es representativa.

Algunos de los principales problemas que enfrentan estos tipos de modelos son:

1.  **Endogeneidad**: Puede haber variables omitidas, errores de medici칩n o causalidad inversa que generen correlaci칩n entre las variables explicativas y el t칠rmino de error, lo cual viola los supuestos del modelo y produce estimadores sesgados e inconsistentes.

2.  **Heterocedasticidad**: La varianza del t칠rmino de error puede no ser constante a trav칠s de las observaciones, lo que viola uno de los supuestos del modelo y puede producir estimadores ineficientes.

3.  **Autocorrelaci칩n**: Los errores pueden estar correlacionados a trav칠s del tiempo para un mismo individuo, lo que tambi칠n viola los supuestos del modelo y puede producir estimadores ineficientes.

4.  **Multicolinealidad**: Puede haber alta correlaci칩n entre algunas variables explicativas, lo que dificulta la estimaci칩n precisa de los coeficientes individuales.

5.  **Datos faltantes:** Es com칰n que haya observaciones faltantes en los datos de panel, lo que puede generar sesgos si no se maneja adecuadamente.

6.  **Selecci칩n de la muestra:** Si la muestra no es aleatoria, puede haber sesgos de selecci칩n que afecten la validez de las inferencias.

Para abordar estos problemas, se utilizan t칠cnicas como el uso de variables instrumentales, correcciones de errores est치ndar robustos, pruebas de especificaci칩n, m칠todos de imputaci칩n de datos faltantes, entre otros.

#### Busque una base de datos que le permita aplicar alg칰n modelo con datos de panel. Plantee una pregunta te칩rica que le permita responder con el modelo que plantea y luego estima.

```{r}
library(haven)
library(plm)
library(dplyr)

data <- read_dta("D:/2024/econometria/pwt1001.dta")
```

Para aplicar un modelo con datos de panel, podemos utilizar la base de datos de Penn World Table (PWT). Esta base de datos contiene informaci칩n sobre diferentes variables econ칩micas de un amplio conjunto de pa칤ses durante un per칤odo de tiempo considerable.

Una pregunta te칩rica relevante que se puede abordar con estos datos es: 쮺칩mo afecta la apertura comercial al crecimiento econ칩mico de un pa칤s?

Para responder a esta pregunta, podemos estimar un modelo de datos de panel que relacione el crecimiento del PIB per c치pita (variable dependiente) con la apertura comercial (variable explicativa) y otras variables de control relevantes, como la inversi칩n, el capital humano, etc.

Fuente datos: <https://www.rug.nl/ggdc/productivity/pwt/>

El modelo general tendr칤a la siguiente forma:

洧녳洧녶洧녮(洧녞洧냪洧냣洧녷洧녫)洧녰洧노 = 洧띻0 + 洧띻1洧냢洧녷洧뉧롐洧노洧녹洧洧녩洧녰洧노 + 洧띻2洧녦洧녰洧노 + 洧띺洧녰 + 洧쮫롐 + 洧洧녰洧노

Donde:

-   `洧녳洧녶洧녮(洧녞洧냪洧냣洧녷洧녫)洧녰洧노` es el logaritmo del PIB per c치pita del pa칤s `i` en el a침o `t`.
-   `洧냢洧녷洧뉧롐洧노洧녹洧洧녩洧녰洧노` es una medida de apertura comercial (por ejemplo, la suma de exportaciones e importaciones como porcentaje del PIB).
-   `洧녦洧녰洧노` es un vector de variables de control.
-   `洧띺洧녰` son los efectos fijos por pa칤s (invariantes en el tiempo).
-   `洧쮫롐` son los efectos fijos por a침o (invariantes entre pa칤ses).
-   `洧洧녰洧노` es el t칠rmino de error.

Aqu칤, `洧띻1` es el coeficiente de inter칠s, que captura el efecto de la apertura comercial sobre el crecimiento econ칩mico.

Para estimar este modelo, podemos utilizar t칠cnicas est치ndar de datos de panel, como efectos fijos o efectos aleatorios, seg칰n corresponda.

Aqu칤, `openk` es la variable de apertura comercial, `inv_share` es la participaci칩n de la inversi칩n en el PIB, y `hc` es una medida de capital humano. El argumento `model = "within"` especifica que estamos estimando un modelo de efectos fijos.

El argumento `index` indica c칩mo se identifica cada observaci칩n en t칠rminos de su individuo y per칤odo de tiempo. Espec칤ficamente, index es un vector de dos elementos que contiene los nombres de las columnas (o factores) que identifican a los individuos y a los per칤odos de tiempo.

La salida del modelo nos proporcionar치 los coeficientes estimados, as칤 como su significancia estad칤stica, lo que nos permitir치 evaluar el efecto de la apertura comercial sobre el crecimiento econ칩mico.

```{r}
# la inversi칩n est치 representada por la variable csh_i, que corresponde a la participaci칩n de la inversi칩n en el PIB a precios constantes. Por lo tanto, no necesitamos realizar c치lculos adicionales. Renombrar la variable:

data <- data %>%
  dplyr::rename(inv_share = csh_i)

#la apertura comercial "openk" se puede calcular como la suma de las exportaciones e importaciones como porcentaje del PIB
data <- data %>%
  mutate(openk = csh_x + csh_m) 
```

```{r}
# Estimar el modelo de efectos fijos
model <- plm(log(rgdpna) ~ openk + inv_share + hc, data = data, 
             index = c("country", "year"), model = "within")

summary(model)
```

.Interpretaci칩n

De acuerdo con la salida proporcionada, puedo interpretar los resultados del modelo de la siguiente manera:

1.  **Coeficientes estimados**:

    -   `openk` (apertura comercial): El coeficiente estimado es 0.384717, lo que indica que un aumento de 1 punto porcentual en la apertura comercial (medida como la suma de exportaciones e importaciones como porcentaje del PIB) est치 asociado con un aumento del 0.384717% en el PIB per c치pita, manteniendo todo lo dem치s constante. Este coeficiente es estad칤sticamente significativo (p-valor \< 2.2e-16).
    -   `inv_share` (participaci칩n de la inversi칩n en el PIB): El coeficiente estimado es 1.567081, lo que implica que un aumento de 1 punto porcentual en la participaci칩n de la inversi칩n en el PIB est치 asociado con un aumento del 1.567081% en el PIB per c치pita, manteniendo todo lo dem치s constante. Este coeficiente tambi칠n es estad칤sticamente significativo (p-valor \< 2.2e-16).
    -   `hc` (capital humano): El coeficiente estimado es 1.730666, lo que sugiere que un aumento de 1 unidad en la medida de capital humano est치 asociado con un aumento del 1.730666% en el PIB per c치pita, manteniendo todo lo dem치s constante. Este coeficiente es estad칤sticamente significativo (p-valor \< 2.2e-16).

2.  **Significancia estad칤stica**: Todos los coeficientes son altamente significativos, con p-valores inferiores a 2.2e-16.

3.  **Bondad de ajuste**: El modelo tiene un R-cuadrado de 0.79034, lo que indica que el 79.034% de la variaci칩n en el PIB per c치pita es explicada por las variables independientes (apertura comercial, participaci칩n de la inversi칩n y capital humano).

4.  **Prueba F**: El estad칤stico F es 10666.8 con un p-valor inferior a 2.22e-16, lo que sugiere que al menos uno de los coeficientes del modelo es diferente de cero y que el modelo es estad칤sticamente significativo.

En general, los resultados sugieren que la apertura comercial, la participaci칩n de la inversi칩n y el capital humano tienen un impacto positivo y estad칤sticamente significativo en el crecimiento del PIB per c치pita. Estos hallazgos son consistentes con la teor칤a econ칩mica y respaldan la hip칩tesis de que una mayor apertura comercial est치 asociada con un mayor crecimiento econ칩mico.

Es importante tener en cuenta que esta interpretaci칩n se basa 칰nicamente en los coeficientes estimados y su significancia estad칤stica. Para una interpretaci칩n m치s completa, tambi칠n ser칤a necesario evaluar las pruebas de diagn칩stico y los supuestos del modelo, como la ausencia de autocorrelaci칩n y heterocedasticidad.
